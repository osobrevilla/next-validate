!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NextValidate=t():e.NextValidate=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(n){var r,o,a;!function(n,i){o=[e,t],r=i,void 0!==(a="function"==typeof r?r.apply(t,o):r)&&(e.exports=a)}(0,function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i={},u={message:"Valor no valido"},s=function(){function e(){r(this,e)}return a(e,null,[{key:"addRule",value:function(t,n){if("string"==typeof t||Array.isArray(t)&&n){var r=Object.assign({},u,n);return[].concat(t).forEach(function(t){i[t]=r,e[t]=function(e){var a={},i=void 0===e?"undefined":o(e);return"string"===i||"number"===i||"boolean"===i?a.value=isNaN(e)?e:Number(e):"object"===i&&!Array.isArray(e)&&e&&(a=e),{test:function(e,t){return this.runtimeOptions.test(e,t,a)},runtimeOptions:Object.assign({},n,r),localOptions:r,args:a,name:t}}}),e}}},{key:"setRuleMessage",value:function(e,t){"string"==typeof e&&"string"==typeof t&&i[e]&&(i[e].message=t)}},{key:"getValidateRule",value:function(e){return i[e]}},{key:"getRules",value:function(){return i}}]),e}();t.default=s;var l={test:function(e,t){return""!=String(e).trim()},message:"El campo es requerido"};s.addRule("email",{_pattern:/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,test:function(e,t){if(e=e.trim())return this._pattern.test(e)},message:"El email no es válido"}).addRule("require",l).addRule("required",l).addRule("alpha",{pattern:/^[a-zA-Z\s\']+$/,test:function(e,t){return this.pattern.test(e)},message:"Solo letras"}).addRule("integer",{blackList:"d",pattern:/^-?\d+$/,test:function(e,t){if(e=String(e).trim())return this.pattern.test(e)},message:"Solo números enteros"}).addRule(["float","decimal"],{whiteList:/[\d|.|-]/,test:function(e,t,n){if(e=e.trim())return n.strict?/^-{0,1}?\d*\.{0,1}\d+$/.test(e):/^-{0,1}?\d*\.{0,1}?\d+?$/.test(e)},message:function(e){return"Solo números"+(e.strict?" con punto decimal":"")}}).addRule("date",{_pattern:/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/,test:function(e,t){if(e=e.trim())return this._pattern.test(e)},message:"Fecha mal formada, por favor usar día/mes/año"}).addRule("compare",{test:function(e,t,n){return("object"===o(n.value)?n.value:document.querySelector(n.value)).value==e},message:"No coinciden los datos"}).addRule("maxlength",{test:function(e,t,n){var r=n.value;return t.maxLength=r,e.length<=r},message:"Máximo {{value}} caracteres"}).addRule("size",{test:function(e,t,n){var r=n.value;if(e)return t.maxLength=r,e.length==r},message:"Deben ser {{value}} caracteres"}).addRule("minlength",{test:function(e,t,n){return!(e=e.trim())||e.length>=n.minlength},message:"mínimo {{value}} caracteres"}).addRule("alphanumeric",{pattern:/^\w+$/,test:function(e,t){if(e=e.trim())return this.pattern.test(e)},message:"Solo números y letras"}).addRule("range",{pattern:/^-?\d+$/,test:function(e,t,n){if(e=Number(String(e).trim()))return e>=n.min&&e<=n.max},message:"Solo números entre {{min}} y {{max}}"}).addRule("visa",{whiteList:/[\d]/,total:16,test:function(e,t,n){if(e=String(e).trim())return e.replace(/\D/g,"").length===this.total},message:function(e,t){var n=String(t.value).trim();return n=n.replace(/\D/g,""),"se requieren "+(this.total-n.length)+" dígitos"}}),n.Validates=s,e.exports=t.default})}).call(t,n(0))},function(e,t,n){(function(r){var o,a,i;!function(r,u){a=[e,t,n(1)],o=u,void 0!==(i="function"==typeof o?o.apply(t,a):o)&&(e.exports=i)}(0,function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s="{{MESSAGE}}",l=/^data-validate-(.+)/,c={select:["blur","change"],"input textarea":["blur","input"]},f={stores:{},on:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.dataset.fvevt||"fv"+Date.now(),a=void 0;a=this.stores[o],a||(a=this.stores[o]={}),a[t]?a[t].push(n):a[t]=[n],e.addEventListener(t,n,r),e.dataset.fvevt=o},off:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.removeEventListener(t,n,r)},offAll:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.dataset.fvevt,a=this.stores[o];if(a)if(n)a[n]&&a[n].forEach(function(o){return t.off(e,n,o,r)});else{for(var i in a)!function(n){a[n].forEach(function(o){return t.off(e,n,o,r)})}(i)}}},d={closest:function(e,t){var n,r=(e.document||e.ownerDocument).querySelectorAll(t);do{for(n=r.length;--n>=0&&r.item(n)!==e;);}while(n<0&&(e=e.parentElement));return e},elementFromString:function(e){var t=void 0,n=document.createElement("div");return n.innerHTML=e,t=n.firstElementChild,n.removeChild(t),t}},v=function(e){var t={},n=!1,r=!0,o=!1,a=void 0;try{for(var i,u=e.attributes[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=i.value;l.test(s.name)&&(n=!0,t[s.name.substr(14)]=s.value)}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n?t:null},m=function(e,t,n){var r=e.target,o=e.which||e.keyCode||e.charCode,a=!0,i=String.fromCharCode(o);a=t.testObjects.filter(function(e){return e.localOptions.hasOwnProperty("blackList")}).reduce(function(e,t){var n=new RegExp("[^"+t.localOptions.blackList+"]","g"),o=r.selectionStart;return console.log(n,r.value),r.value=r.value.replace(n,""),r.selectionEnd=o,!n.test(i)*e},!0),0==a&&e.preventDefault(),n.validateControl(t)},p=function(e){var t={},n=/^(true|false)$/;return"string"===(void 0===e?"undefined":u(e))&&(isNaN(e)?e.split(",").map(function(e){return e.trim().split(":")}).forEach(function(e){var r=e[1];t[e[0].trim()]=isNaN(r)?n.test(r=r.trim().toLowerCase())?"true"==r:r:Number(r)}):t.value=Number(e)),t},h=function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var u=a.value;"function"==typeof u&&(u=u()),"required"===name||"require"===name?t.splice(0,0,u):t.push(u)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return t},y=function(e){return[].slice.call(e.querySelectorAll(g().join(", ")))},g=function(){return Object.keys(a.default.getRules()).map(function(e){return"[data-validate-"+e+"]"})},b=function(e){return["checkbox","radio"].includes(e.type)?e.checked?e.value:"":e.value},k=function(e,t){var n=e.runtimeOptions.message;return"function"==typeof n?n.call(e.runtimeOptions,e.args,t):n},_=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.options=Object.assign({errorMessageTemplate:""},r),this.form=t,this.form.classList.add("next-validate"),this._validates_=[],r.validates?this.compileFunctions(r.validates):this._parse(),f.on(this.form,"submit",function(e){if(!n.isValid())return e.preventDefault(),n.form.classList.remove("form-valid"),!1;n.form.classList.add("form-valid")})}return i(e,[{key:"_parse",value:function(){var e=this;y(this.form).map(function(e){return{field:e,attrs:v(e)}}).forEach(function(t){var n=[];for(var r in t.attrs)a.default[r]&&(t.attrs[r]?n.push(a.default[r.toLowerCase()](p(t.attrs[r]))):n.push(a.default[r.toLowerCase()]));e.compileFunction(t.field,n)})}},{key:"compileFunctions",value:function(e){for(var t in e){var n=this.form[t];if(n){var r=e[t];this.compileFunction(n,r)}}}},{key:"compileFunction",value:function(e,t){var n={field:e,testObjects:h(t)};this._validates_.push(n),this._bindEvents(n)}},{key:"getFormGroup",value:function(e){var t=d.closest(e,".form-group");return t||e.parentElement}},{key:"_bindEvent",value:function(e,t){var n=this,r=e.field,o=t,a=this;switch(t){case"input":f.on(r,o,function(t){m(t,e,a)},!1);break;case"blur":case"keyup":case"click":f.on(r,o,function(t){n.validateControl(e)},!1)}}},{key:"_unbindEvents",value:function(){this._validates_.forEach(function(e){return f.offAll(e.field)})}},{key:"_bindEvents",value:function(e){var t=e.field,n=t.tagName.toLowerCase();for(var r in c)if(r.indexOf(n)>=0)for(var o in c[r])this._bindEvent(e,c[r][o]);"input"===n&&["checkbox","radio"].indexOf(t.type)>=0&&this._bindEvent(e,"click")}},{key:"_buildMessageBlock",value:function(e){return e=e||"Este valor es incorrecto",('<div class="form-control-feedback">'+(this.options.errorMessageTemplate||s)+"</div>").replace("{{MESSAGE}}",e)}},{key:"_putMessage",value:function(e,t){this.removeMessage(e),t&&(e.classList.add("has-error"),e.appendChild(d.elementFromString(this._buildMessageBlock(t))))}},{key:"_buildMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];for(var n in t)e=e.replace(new RegExp("\\{\\{"+n+"\\}\\}","g"),t[n]);return e}},{key:"removeMessage",value:function(e){var t=this.getFormGroup(e),n=t.querySelectorAll(".form-control-feedback");t.classList.remove("has-error","has-success");var r=!0,o=!1,a=void 0;try{for(var i,u=n[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=i.value;s.parentNode.removeChild(s)}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}},{key:"displayMessage",value:function(e,t,n,r){var o=this;this._putMessage(this.getFormGroup(e),this._buildMessage(t,n)),r&&setTimeout(function(){return o.removeMessage(e)},r)}},{key:"validateControl",value:function(e){var t=!0,n=e.field;if(null===n.offsetParent)return t;if(n.hasAttribute("disabled"))return t;var r=!0,o=!1,a=void 0;try{for(var i,u=e.testObjects[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=i.value;if(void 0!==(t*=!!s.test(b(n),n))){if(!t){this.displayMessage(n,k(s,n),s.args);break}this.removeMessage(n)}else this.removeMessage(n)}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return t}},{key:"isValid",value:function(){var e=this,t=!0;return[].forEach.call(this._validates_,function(n){return t*=e.validateControl(n)}),t}},{key:"refresh",value:function(){f.offAll(this.form),this._unbindEvents()}}],[{key:"setMessageErrorTemplate",value:function(e){s=e}}]),e}();t.default=_,r.Validates=a.default,r.NextValidate=_,_.Validates=_,e.exports=t.default})}).call(t,n(0))}])});